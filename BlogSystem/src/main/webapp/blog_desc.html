<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>博客详情页</title>
    <link rel="stylesheet" href="CSS/common.css">
    <link rel="stylesheet" href="CSS/blog_desc.css">

    <!-- 引入 editor.md 的依赖 -->
    <link rel="stylesheet" href="editor.md/css/editormd.min.css" />
    <script src="js/jquery.min.js"></script>
    <script src="editor.md/lib/marked.min.js"></script>
    <script src="editor.md/lib/prettify.min.js"></script>
    <script src="editor.md/editormd.js"></script>
</head>
<body>
        <!-- 导航栏 -->
        <div class="nav">
            <img src="image/tiger.png" >
            <span>我的博客系统</span>
            <a href="#">主页</a>
            <a href="#">写博客</a>
            <a href="#">注销</a>
        </div>
        <!-- 版心 -->
        <div class="container">
            <!-- 左边栏 -->
            <div class="left">
                <!-- 卡片信息 -->
                <div class="card">
                    <img src="image/dog.png" alt="">
                    <span>比特学生</span>
                    <a href="#">github 地址</a>
                    <div class="res">
                        <span>文章</span>
                        <span>分类</span>
                    </div>
                    <div class="res">
                        <span>2</span>
                        <span>1</span>
                    </div>
                </div>
            </div>
            <!-- 右边栏 -->
            <div class="right">
                <!-- 这里是一篇博客的具体内容 -->
                <div class="desc">
                    <!-- 博客标题 -->
                    <h2 class="title"></h2>
                    <!-- 博客时间 -->
                    <div class="date"></div>
                    <!-- 博客正文 -->
                    <div id="content" style="opacity:80%;">

                    </div>
                </div>
            </div>
        </div>

        <script src="./js/jquery.min.js"></script>
        <script>
            function getBlogByBlogId(){
                $.ajax({
                    type:'get',
                    // 通过 location.search 就可以拿到类似于：?blogId=5 的完整 QueryString
                    url:'blog' + location.search,
                    success:function(body){
                        //这 js 会将 body 中的数据转换成一个 json 格式的对象
                        
                        //填充博客标题
                        let title = document.querySelector('.title');
                        title.innerHTML = body.title;

                        //填充博客时间
                        let date = document.querySelector('.date');
                        date.innerHTML = body.postTime;

                        //填充博客正文
                        // let content = document.querySelector('p');
                        // content.innerHTML = body.content;
                        editormd.markdownToHTML('content',{
                            markdown : body.content,
                        });

                    }
                });
            };
            getBlogByBlogId();
        </script>

        <script>
            function getUserInfo(){
                $.ajax({
                    type:'get',
                    url:'login',
                    success:function(body){
                        //判断body中对象的 userId = 0
                        if(body.username && body.userId > 0){
                            console.log("用户以登录,用户:"+body.username);
                        }else{
                            alert("请先进行用户登录!");
                            location.assign('blog_login.html');
                        }
                    },
                });
            };

            getUserInfo();
        </script>  
        
</body>
</html>